<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <!-- Materialize CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/custom.css') }}">
    <title>DoloChores</title>
  </head>
  <body>
    <header>
        <nav>
            <div class="nav-wrapper">
                <a href="{{ url_for('all_chores') }}" class="brand-logo" style="padding-left: 15px;">DoloChores</a>
                <a href="#" data-target="mobile-nav" class="sidenav-trigger"><i class="material-icons">menu</i></a>
                <ul id="nav-mobile" class="right hide-on-med-and-down">
                    <li><a href="{{ url_for('all_chores') }}">All Chores</a></li>
                    <li><a href="{{ url_for('priorities') }}">Priorities</a></li>
                    <li><a class="dropdown-trigger" href="#!" data-target="my-chores-dropdown">My Chores<i class="material-icons right">arrow_drop_down</i></a></li>
                    <li><a href="{{ url_for('search') }}"><i class="material-icons">search</i></a></li>
                    <li><a class="dropdown-trigger" href="#!" data-target="more-actions-dropdown"><i class="material-icons">more_vert</i></a></li>
                </ul>
            </div>
        </nav>

        <!-- Sidenav Structure -->
        <ul id="mobile-nav" class="sidenav">
            <li><a href="{{ url_for('all_chores') }}">All Chores</a></li>
            <li><a href="{{ url_for('priorities') }}">Priorities</a></li>
            <li class="divider"></li>
            <li><a class="subheader">My Chores</a></li>
            <li><a href="{{ url_for('my_chores', username='Dan') }}">Dan's Chores</a></li>
            <li><a href="{{ url_for('my_chores', username='Kim') }}">Kim's Chores</a></li>
            <li><a href="{{ url_for('my_chores', username='Katie') }}">Katie's Chores</a></li>
            <li class="divider"></li>
            <li><a href="{{ url_for('search') }}">Search</a></li>
            <li><a href="#" data-target="add-chore-modal" class="modal-trigger">Add Chore</a></li>
            <li><a href="#" id="email-chores-btn-mobile">Email Chores List</a></li>
        </ul>

        <!-- Dropdown Structures for Desktop -->
        <ul id="my-chores-dropdown" class="dropdown-content">
            <li><a href="{{ url_for('my_chores', username='Dan') }}">Dan's Chores</a></li>
            <li><a href="{{ url_for('my_chores', username='Kim') }}">Kim's Chores</a></li>
            <li><a href="{{ url_for('my_chores', username='Katie') }}">Katie's Chores</a></li>
        </ul>
        <ul id="more-actions-dropdown" class="dropdown-content">
            <li><a href="#" data-target="add-chore-modal" class="modal-trigger">Add Chore</a></li>
            <li><a href="#" id="email-chores-btn">Email Chores List</a></li>
        </ul>
    </header>

    <main class="container">
        {% block content %}{% endblock %}
    </main>

    <!-- Add Chore Modal -->
    <div id="add-chore-modal" class="modal">
        <div class="modal-content">
            <h4>Add a New Chore</h4>
            <form id="add-chore-form">
                <div class="row">
                    <div class="input-field col s6">
                        <input type="text" id="title" name="title" required>
                        <label for="title">Title</label>
                    </div>
                    <div class="input-field col s6">
                        <select id="user_id" name="user_id" required>
                            {% for user in users %}
                            <option value="{{ user.id }}">{{ user.name }}</option>
                            {% endfor %}
                        </select>
                        <label>Assignee</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s4">
                        <select id="category" name="category">
                            <option value="all rooms">all rooms</option>
                            <option value="bathroom">bathroom</option>
                            <option value="bedrooms">bedrooms</option>
                            <option value="counters">counters</option>
                            <option value="floors">floors</option>
                            <option value="garage">garage</option>
                            <option value="hvac">hvac</option>
                            <option value="kitchen">kitchen</option>
                            <option value="laundry">laundry</option>
                            <option value="outside">outside</option>
                            <option value="plumbing">plumbing</option>
                            <option value="riley">riley</option>
                        </select>
                        <label>Category</label>
                    </div>
                    <div class="input-field col s4">
                        <select id="frequency" name="frequency" required>
                            <option value="14">14</option>
                            <option value="30">30</option>
                            <option value="90">90</option>
                            <option value="182">182</option>
                            <option value="365">365</option>
                            <option value="730">730</option>
                            <option value="1095">1095</option>
                            <option value="2555">2555</option>
                        </select>
                        <label>Frequency (days)</label>
                    </div>
                    <div class="input-field col s4">
                        <input type="date" id="last_completed" name="last_completed" class="datepicker" required>
                        <label for="last_completed">Last Completed</label>
                    </div>
                </div>
                <div class="row">
                    <div class="input-field col s12">
                        <textarea id="notes" name="notes" class="materialize-textarea"></textarea>
                        <label for="notes">Notes</label>
                    </div>
                </div>
                <div class="modal-footer">
                    <a href="#!" class="modal-close waves-effect waves-green btn-flat">Cancel</a>
                    <button type="submit" class="btn waves-effect waves-light">Add Chore</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Chore Detail Modal -->
    <div id="chore-detail-modal" class="modal">
      <div class="modal-content">
        <h4 id="chore-detail-title">Chore Details</h4>
        <div id="chore-detail-content">
            <!-- Chore details will be populated here by JS -->
        </div>
      </div>
      <div class="modal-footer">
        <a href="#!" id="chore-detail-delete-btn" class="waves-effect waves-red btn-flat">Delete</a>
        <a href="#!" class="modal-close waves-effect waves-green btn-flat">Close</a>
      </div>
    </div>

    <!-- Materialize JS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize Sidenav
            var sidenavs = document.querySelectorAll('.sidenav');
            M.Sidenav.init(sidenavs, {});

            // Initialize dropdowns
            var dropdowns = document.querySelectorAll('.dropdown-trigger');
            M.Dropdown.init(dropdowns, {});

            // Initialize modals
            var addModal = document.getElementById('add-chore-modal');
            M.Modal.init(addModal, {});

            var detailModal = document.getElementById('chore-detail-modal');
            M.Modal.init(detailModal, {
                onOpenStart: function(modal, trigger) {
                    const choreItem = trigger.closest('.collection-item');
                    if (choreItem) {
                        const choreId = choreItem.dataset.choreId;
                        if (choreId) {
                            loadChoreDetails(choreId);
                        }
                    }
                }
            });

            // Initialize select lists
            var selects = document.querySelectorAll('select');
            M.FormSelect.init(selects, {});

            // Initialize date pickers
            var datepickers = document.querySelectorAll('.datepicker');
            M.Datepicker.init(datepickers, {
                format: 'yyyy-mm-dd',
                autoClose: true
            });
        });
    </script>
  </body>
</html>
