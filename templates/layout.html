<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Material Symbols -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <!-- Material Web Components -->
    <script type="importmap">
      {
        "imports": {
          "@material/web/": "https://esm.run/@material/web/"
        }
      }
    </script>
    <script type="module">
      import '@material/web/all.js';
      import {styles as typescaleStyles} from '@material/web/typography/md-typescale-styles.js';
      document.adoptedStyleSheets.push(typescaleStyles.styleSheet);
    </script>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/custom.css') }}">
    <title>DoloChores</title>
    <style>
      /* Global theme overrides */
      :root {
        --md-sys-color-primary: #006A6A;
        /* Add other theme tokens here if needed */
      }
      body {
        font-family: 'Roboto', sans-serif;
      }
    </style>
  </head>
  <body>
    <header>
        <md-top-app-bar>
            <div class="top-bar-layout">
                <div class="top-bar-start">
                    <md-icon-button href="{{ url_for('all_chores') }}" aria-label="Home">
                        <md-icon>home</md-icon>
                    </md-icon-button>
                </div>
                <div class="top-bar-center">
                    <form method="get" action="{{ url_for('search') }}" class="search-form">
                        <md-outlined-text-field
                            placeholder="Search..."
                            name="q"
                            value="{{ request.args.get('q', '') }}"
                        >
                            <md-icon slot="leading-icon">search</md-icon>
                        </md-outlined-text-field>
                    </form>
                </div>
                <div class="top-bar-end">
                    <md-icon-button id="add-chore-button" aria-label="Add Chore">
                        <md-icon>add_circle</md-icon>
                    </md-icon-button>
                    <md-icon-button id="email-button" aria-label="Email Chores">
                        <md-icon>mail</md-icon>
                    </md-icon-button>
                </div>
            </div>
        </md-top-app-bar>
    </header>

    <main class="container">
        {% block content %}{% endblock %}
    </main>

    <footer>
        <div class="tabs-container">
            <md-tabs id="main-tabs">
                <md-primary-tab href="{{ url_for('all_chores') }}">
                    All Chores
                    <md-icon slot="icon">list</md-icon>
                </md-primary-tab>
                <md-primary-tab href="{{ url_for('priorities') }}">
                    Priorities
                    <md-icon slot="icon">star</md-icon>
                </md-primary-tab>
                <md-primary-tab id="my-chores-tab">
                    My Chores
                    <md-icon slot="icon">person</md-icon>
                </md-primary-tab>
            </md-tabs>
            <md-menu id="my-chores-menu" anchor="my-chores-tab" menu-corner="start-start" anchor-corner="end-start">
                {% for user in users %}
                <md-menu-item href="{{ url_for('my_chores', username=user.name) }}">
                    <div slot="headline">{{ user.name }}'s Chores</div>
                </md-menu-item>
                {% endfor %}
            </md-menu>
        </div>
    </footer>

    <md-dialog id="add-chore-dialog">
        <div slot="headline">Add a New Chore</div>
        <form id="add-chore-form" slot="content" style="display: flex; flex-direction: column; gap: 16px;">
            <md-outlined-text-field label="Title" name="title" required></md-outlined-text-field>
            <md-outlined-select label="Assignee" name="user_id" required>
                {% for user in users %}
                <md-select-option value="{{ user.id }}">
                    <div slot="headline">{{ user.name }}</div>
                </md-select-option>
                {% endfor %}
            </md-outlined-select>
            <md-outlined-select label="Category" name="category">
                <md-select-option value="all rooms"><div slot="headline">all rooms</div></md-select-option>
                <md-select-option value="bathroom"><div slot="headline">bathroom</div></md-select-option>
                <md-select-option value="bedrooms"><div slot="headline">bedrooms</div></md-select-option>
                <md-select-option value="counters"><div slot="headline">counters</div></md-select-option>
                <md-select-option value="floors"><div slot="headline">floors</div></md-select-option>
                <md-select-option value="garage"><div slot="headline">garage</div></md-select-option>
                <md-select-option value="hvac"><div slot="headline">hvac</div></md-select-option>
                <md-select-option value="kitchen"><div slot="headline">kitchen</div></md-select-option>
                <md-select-option value="laundry"><div slot="headline">laundry</div></md-select-option>
                <md-select-option value="outside"><div slot="headline">outside</div></md-select-option>
                <md-select-option value="plumbing"><div slot="headline">plumbing</div></md-select-option>
                <md-select-option value="riley"><div slot="headline">riley</div></md-select-option>
            </md-outlined-select>
            <md-outlined-select label="Frequency (days)" name="frequency" required>
                <md-select-option value="14"><div slot="headline">14</div></md-select-option>
                <md-select-option value="30"><div slot="headline">30</div></md-select-option>
                <md-select-option value="90"><div slot="headline">90</div></md-select-option>
                <md-select-option value="182"><div slot="headline">182</div></md-select-option>
                <md-select-option value="365"><div slot="headline">365</div></md-select-option>
                <md-select-option value="730"><div slot="headline">730</div></md-select-option>
                <md-select-option value="1095"><div slot="headline">1095</div></md-select-option>
                <md-select-option value="2555"><div slot="headline">2555</div></md-select-option>
            </md-outlined-select>
            <md-outlined-text-field label="Last Completed" name="last_completed" type="date" required></md-outlined-text-field>
            <md-outlined-text-field label="Notes" name="notes" type="textarea"></md-outlined-text-field>
        </form>
        <div slot="actions">
            <md-text-button id="add-chore-cancel-btn">Cancel</md-text-button>
            <md-filled-button type="submit" form="add-chore-form">Add Chore</md-filled-button>
        </div>
    </md-dialog>

    <md-dialog id="chore-detail-dialog">
        <div slot="headline" style="display: flex; justify-content: space-between; align-items: center;">
            <span id="chore-detail-title">Chore Details</span>
            <md-icon-button id="chore-detail-close-icon-btn" form="chore-edit-form" value="close" aria-label="Close dialog">
                <md-icon>close</md-icon>
            </md-icon-button>
        </div>
        <div slot="content">
            <div id="chore-detail-readonly-view">
                <!-- Chore details will be populated here by JS -->
            </div>
            <form id="chore-edit-form" style="display: none; flex-direction: column; gap: 16px;">
                <input type="hidden" name="chore_id">
                <md-outlined-text-field label="Title" name="title" required></md-outlined-text-field>
                <md-outlined-select label="Assignee" name="user_id" required>
                    {% for user in users %}
                    <md-select-option value="{{ user.id }}">
                        <div slot="headline">{{ user.name }}</div>
                    </md-select-option>
                    {% endfor %}
                </md-outlined-select>
                <md-outlined-select label="Category" name="category">
                     <md-select-option value="all rooms"><div slot="headline">all rooms</div></md-select-option>
                    <md-select-option value="bathroom"><div slot="headline">bathroom</div></md-select-option>
                    <md-select-option value="bedrooms"><div slot="headline">bedrooms</div></md-select-option>
                    <md-select-option value="counters"><div slot="headline">counters</div></md-select-option>
                    <md-select-option value="floors"><div slot="headline">floors</div></md-select-option>
                    <md-select-option value="garage"><div slot="headline">garage</div></md-select-option>
                    <md-select-option value="hvac"><div slot="headline">hvac</div></md-select-option>
                    <md-select-option value="kitchen"><div slot="headline">kitchen</div></md-select-option>
                    <md-select-option value="laundry"><div slot="headline">laundry</div></md-select-option>
                    <md-select-option value="outside"><div slot="headline">outside</div></md-select-option>
                    <md-select-option value="plumbing"><div slot="headline">plumbing</div></md-select-option>
                    <md-select-option value="riley"><div slot="headline">riley</div></md-select-option>
                </md-outlined-select>
                <md-outlined-select label="Frequency (days)" name="frequency" required>
                    <md-select-option value="14"><div slot="headline">14</div></md-select-option>
                    <md-select-option value="30"><div slot="headline">30</div></md-select-option>
                    <md-select-option value="90"><div slot="headline">90</div></md-select-option>
                    <md-select-option value="182"><div slot="headline">182</div></md-select-option>
                    <md-select-option value="365"><div slot="headline">365</div></md-select-option>
                    <md-select-option value="730"><div slot="headline">730</div></md-select-option>
                    <md-select-option value="1095"><div slot="headline">1095</div></md-select-option>
                    <md-select-option value="2555"><div slot="headline">2555</div></md-select-option>
                </md-outlined-select>
                <md-outlined-text-field label="Last Completed" name="last_completed" type="date" required></md-outlined-text-field>
                <md-outlined-text-field label="Notes" name="notes" type="textarea"></md-outlined-text-field>
                <md-checkbox name="is_priority" touch-target="wrapper">Priority</md-checkbox>
            </form>
        </div>
        <div slot="actions">
            <md-text-button id="chore-detail-delete-btn" style="--md-text-button-label-text-color: var(--md-sys-color-error);">Delete</md-text-button>
            <div style="flex: 1;"></div> <!-- Spacer -->
            <md-text-button id="chore-detail-edit-btn">Edit</md-text-button>
            <md-filled-button id="chore-detail-save-btn" type="submit" form="chore-edit-form" style="display: none;">Save</md-filled-button>
        </div>
    </md-dialog>

    <!-- App-specific JS -->
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
  </body>
</html>
